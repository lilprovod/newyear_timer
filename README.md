# New Year Timer (INT 60h)

Небольшая программа на x86-ассемблере для DOS/DOSBox, которая считает,
сколько осталось до Нового года, и выводит строку вида:

`Time left until New Year: [DDD / HH:mm:ss]`

- `DDD` - количество дней до 1 января следующего года (0..365)
- `HH`  - часов до полуночи (0..23)
- `mm`  - минут до следующего часа (0..59)
- `ss`  - секунд до следующей минуты (0..59)

Программа устанавливает свой обработчик прерывания `INT 60h`,
вычисляет оставшееся время до Нового года через RTC, печатает
результат и восстанавливает старый обработчик.

---

## Требования

- DOSBox или реальная DOS-среда
- Компилятор MASM

---

## Автоматическая сборка

Для автоматической сборки используйте скрипт `build.bat`.
Его нужно запускать из корня проекта - там же, где лежат
папки `src` и `masm`. Структура проекта может выглядеть так:
```text
newyear_timer/
├─ src/
│  └─ NY.asm
├─ masm/
│  ├─ masm.exe
│  └─ link.exe
├─ bin/
├─ build.bat
├─ README.md
```
В DOSBox достаточно выполнить:
```bat
build
```

По умолчанию это соберёт `src\NY.asm` в `bin\NY.exe`.
Можно также указать имя программы без расширения:
```bat
build NY
build MYPROG
```

В этом случае будут собраны `src\NY.asm` и `src\MYPROG.asm`
соответственно.

---

## Ручная сборка

Пример сборки программы для MASM внутри DOSBox:

```bat
mount F C:\<path_to_MASM>
F:
masm NY.asm
link NY.obj
```

После сборки получится исполняемый файл `NY.exe`, который
после запуска выведет на экран сообщение с оставшимся временем.

Пример вывода:

`Time left until New Year: [046 / 00:00:50]`

---

## Запуск через расширение VS Code
Чтобы запустить эту программу, можно использовать расширение
Visual Studio Code - **MASM/TASM** от clcxrolau.

Для этого необходимо:
1. Установить расширение [MASM/TASM](https://marketplace.visualstudio.com/items?itemName=xsro.masm-tasm) для VS Code
2. Открыть файл `NY.ASM` с исходным кодом
3. Нажать ПКМ в свободном месте редактора кода
4. Использовать опцию `Run ASM code`

Теперь можно проверить программу в эмуляторе DOS прямо
из Visual Studio Code.

---

## TODO

- [x] Добавить `build.bat` для автоматической сборки в DOSBox
- [x] Учесть високосные годы при расчёте дней
- [ ] Добавить пример вывода со скришотом из DOSBox

